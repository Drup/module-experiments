\begin{mathpar}
  % \inferrule[ModVar]
  % { \Smodulety{\ix}{\iM} \in \E }
  % { \wtm{\E}{\ix}{\Salias{\ix}} }
  % \and
  \inferrule[ModVar]
  { \ip \in \E }
  % { \wtm{\E}{\ip.\ix}{\substs{n}{\ip.n}{\bv{\iS_1}}{\iM}} }
  { \wtm{\E}{\ip}{\Salias{\ip}} }
  \and
  % \inferrule[Strength]
  % { \wtm{\E}{\ip}{\iM} }
  % { \wtm{\E}{\ip}{\Sstrengthen{}{\ip}{\iM}} }
  % \and
  % \inferrule
  % { \wtm{\E}{\im}{\iM'} \\ \submod{\E}{\iM'}{\iM}{\_} }
  % { \wtm{\E}{\im}{\iM} }
  % \and
  \inferrule
  { \wtm{\E}{\im}{\iM'} \\\submod{\E}{\iM'}{\iM}{\_} }
  { \wtm{\E}{\Sconstraint{\im}{\iM}}{\iM} }
  \and
  \inferrule
  { \wtm{\E}{\im}{\iM'} \\ \submod{\E}{\iM'}{\iM}{\iM_r} }
  { \wtm{\E}{\Stransp{\im}{\iM}}{\iM_r} }
  %
  \and
  \inferrule
  { \wtm{\E}{\im_f}{\Sfunctor{\ix}{\iM_a}{\iM_r}} \\
    \iy \text{ fresh}\\
    \wtm{\E}{\im}{\iM} \\
    \submod{\E}{\iM}{\iM_a}{\iM_c}
  }
  { \wtm{\E}{\Sapp{\im_f}{\im}}
    {\Ssubst{\iy : \iM_c}{\subst{\ix}{\iy}{\iM_r}}} }
  \and
  % \inferrule
  % { \wtm{\E}{\im_f}{\Sfunctor{\ix}{\iM}{\iM_r}} \\
  %   \wtm{\E}{\im_a}{\iM_a} \\
  %   \submod{\E}{\iM_a}{\iM}
  % }
  % { \wtm{\E}{\Sapp{\im_f}{\im_a}}{\iM_r} }
  % \and
  \inferrule
  { \wfm{\E}{\iM} \\
    X \notin \E \\
    \wtm{\E;\Smodulety{X}{\iM}}{\im}{\iM'}
  }
  { \wtm{\E}{\Sfunctor{X}{\iM}{\im}}{\Sfunctor{X}{\iM}{\iM'}} }
  \and
  \inferrule
  { \wtm[\ix]{\E}{\is}{\iS} }
  { \wtm{\E}{\Sstruct{\ix}{\is}}{\Ssig{\ix}{\iS}} }
  \and
  \inferrule
  { }
  { \wtm[\iy]{\E}{\Sempty}{\Sempty} }
  %
  \\
  \inferrule
  { \wt{\E}{e}{\tau} \\
    x \notin \lookup{\E}{\iy} \\
    \wtm[\iy]{\E;\Sval{\iy.x}{\tau}}{\is}{\iS}
  }
  { \wtm[\iy]{\E}{(\Slet{x}{e}; \is)}{(\Sval{x}{\tau}; \iS)} }
  \and
  \inferrule
  { \wtm{\E}{\im}{\iM} \\
    % \submod{\E}{\Sstrengthen{}{\im}{\iM'}}{\iM} \\
    \ix \notin \lookup{\E}{\iy} \\
    \wtm[\iy]{\E;\Smodulety{\iy.\ix}{\iM}}{\is}{\iS}
  }
  { \wtm[\iy]{\E}{(\Smodule{\ix}{\im}; \is)}{(\Smodulety{\ix}{\iM}; \iS)} }
  \and
  \inferrule
  { \wf{\E}{\tau} \\
    t \notin \lookup{\E}{\iy} \\
    \wtm[\iy]{\E;\Stype{\iy.t}{\tau}}{\is}{\iS}
  }
  { \wtm[\iy]{\E}{(\Stype{t}{\tau}; \is)}{(\Stype{t}{\tau}; \iS)} }
  \and
  \inferrule
  { \wfm{\E}{\iM} \\
    \iX \notin \lookup{\E}{\iy} \\
    \wtm[\iy]{\E;\Smoduletype{\iy.\iX}{\iM}}{\is}{\iS}
  }
  { \wtm[\iy]{\E}{(\Smoduletype{\iX}{\iM}; \is)}{(\Smoduletype{\iX}{\iM}; \iS)} }
  % \and
  % \inferrule
  % { \wtm[\sideX]{\E}{(\struct{\is})}{(\signature{\valm[
  % { \wtp{\E}{(\prog{\is})}{\tau} }
\end{mathpar}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
