\begin{mathpar}
  % \inferrule[ModVar]
  % { \Smodulety{\ix_i}{\iM} \in \E }
  % { \wtm{\E}{\ix_i}{\Salias{\ix_i}} }
  % \and
  \inferrule[ModVar]
  { \lookup{\E}{\ip} = \_ }
  % { \wtm{\E}{\ip.\ix}{\substs{n_i}{\ip.n}{\bv{\iS_1}}{\iM}} }
  { \wtm{\E}{\ip}{\Salias{\ip}} }
  \and
  % \inferrule[Strength]
  % { \wtm{\E}{\ip}{\iM} }
  % { \wtm{\E}{\ip}{\Sstrengthen{}{\ip}{\iM}} }
  % \and
  \inferrule
  { \wtm{\E}{\im}{\iM'} \\ \submod{\E}{\iM'}{\iM}{\_} }
  { \wtm{\E}{\im}{\iM} }
  \and
  \inferrule
  { \wfm{\E}{\iM} \\ \wtm{\E}{\im}{\iM} }
  { \wtm{\E}{\Sconstraint{\im}{\iM}}{\iM} }
  \and
  \inferrule
  { \wtm{\E}{\im}{\iM_i} \\ \submod{\E}{\iM_i}{\iM}{\iM_r} }
  { \wtm{\E}{\Stransp{\im}{\iM}}{\iM_r} }
  %
  \and
  \inferrule
  { \wtm{\E}{\im_f}{\Sfunctor{\ix}{\iM_a}{\iM_r}} \\
    \wtm{\E}{\im}{\iM} \\
    \submod{\E}{\iM}{\iM_a}{\iM_c}
  }
  { \wtm{\E}{\Sapp{\im_f}{\im}}
    {\Ssubst{\ix : \iM_c}{\iM_r}} }
  \and
  % \inferrule
  % { \wtm{\E}{\im_f}{\Sfunctor{\ix_i}{\iM}{\iM_r}} \\
  %   \wtm{\E}{\im_a}{\iM_a} \\
  %   \submod{\E}{\iM_a}{\iM}
  % }
  % { \wtm{\E}{\Sapp{\im_f}{\im_a}}{\iM_r} }
  % \and
  \inferrule
  { \wfm{\E}{\iM} \\
    X_i \notin \bv{\E} \\
    \wtm{\E;\Smodulety{X_i}{\iM}}{\im}{\iM'}
  }
  { \wtm{\E}{\Sfunctor{X_i}{\iM}{\im}}{\Sfunctor{X_i}{\iM}{\iM'}} }
  \and
  \inferrule
  { \wtm{\E}{\is}{\iS} }
  { \wtm{\E}{\Sstruct{\is}}{\Ssig{\iS}} }
  \and
  \inferrule
  { }
  { \wtm{\E}{\Sempty}{\Sempty} }
  %
  \\
  \inferrule
  { \wt{\E}{e}{\tau} \\
    x_i \notin \bv{\E} \\
    \wtm{\E;\Sval{x_i}{\tau}}{\is}{\iS}
  }
  { \wtm{\E}{(\Slet{x_i}{e}; \is)}{(\Sval{x_i}{\tau}; \iS)} }
  \and
  \inferrule
  { \wtm{\E}{\im}{\iM} \\
    % \submod{\E}{\Sstrengthen{}{\im}{\iM'}}{\iM} \\
    \ix_i \notin \bv{\E} \\
    \wtm{\E;\Smodulety{\ix_i}{\iM}}{\is}{\iS}
  }
  { \wtm{\E}{(\Smodule{\ix_i}{\im}; \is)}{(\Smodulety{\ix_i}{\iM}; \iS)} }
  \and
  \inferrule
  { \wf{\E}{\tau} \\
    t_i \notin \bv{\E} \\
    \wtm{\E;\Stype{t_i}{\tau}}{\is}{\iS}
  }
  { \wtm{\E}{(\Stype{t}{\tau}; \is)}{(\Stype{t}{\tau}; \iS)} }
  \and
  \inferrule
  { \wfm{\E}{\iM} \\
    \iX_i \notin \bv{\E} \\
    \wtm{\E;\Smoduletype{\iX_i}{\iM}}{\is}{\iS}
  }
  { \wtm{\E}{(\Smoduletype{\iX_i}{\iM}; \is)}{(\Smoduletype{\iX_i}{\iM}; \iS)} }
  % \and
  % \inferrule
  % { \wtm[\sideX]{\E}{(\struct{\is})}{(\signature{\valm[
  % { \wtp{\E}{(\prog{\is})}{\tau} }
\end{mathpar}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
